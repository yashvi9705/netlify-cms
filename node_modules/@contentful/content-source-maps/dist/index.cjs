"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});var _={0:8203,1:8204,2:8205,3:8290,4:8291,5:8288,6:65279,7:8289,8:119155,9:119156,a:119157,b:119158,c:119159,d:119160,e:119161,f:119162},x={0:8203,1:8204,2:8205,3:65279},F=new Array(4).fill(String.fromCodePoint(x[0])).join(""),V="\0";function D(e){let t=JSON.stringify(e);return`${F}${Array.from(t).map(o=>{let n=o.charCodeAt(0);if(n>255)throw new Error(`Only ASCII edit info can be encoded. Error attempting to encode ${t} on character ${o} (${n})`);return Array.from(n.toString(4).padStart(4,"0")).map(r=>String.fromCodePoint(x[r])).join("")}).join("")}`}function G(e){return!Number.isNaN(Number(e))||/[a-z]/i.test(e)&&!/\d+(?:[-:\/]\d+){2}(?:T\d+(?:[-:\/]\d+){1,2}(\.\d+)?Z?)?/.test(e)?!1:!!Date.parse(e)}function z(e){try{new URL(e,e.startsWith("/")?"https://acme.com":void 0)}catch(t){return!1}return!0}function Z(e,t,o="auto"){return o===!0||o==="auto"&&(G(e)||z(e))?e:`${e}${D(t)}`}var H=Object.fromEntries(Object.entries(x).map(e=>e.reverse())),W=Object.fromEntries(Object.entries(_).map(e=>e.reverse())),K=`${Object.values(_).map(e=>`\\u{${e.toString(16)}}`).join("")}`,C=new RegExp(`[${K}]{4,}`,"gu");function X(e){let t=e.match(C);if(t)return Y(t[0],!0)[0]}function Y(e,t=!1){let o=Array.from(e);if(o.length%2===0){if(o.length%4||!e.startsWith(F))return q(o,t)}else throw new Error("Encoded data has invalid length");let n=[];for(let r=o.length*.25;r--;){let s=o.slice(r*4,r*4+4).map(i=>H[i.codePointAt(0)]).join("");n.unshift(String.fromCharCode(parseInt(s,4)))}if(t){n.shift();let r=n.indexOf(V);return r===-1&&(r=n.length),[JSON.parse(n.slice(0,r).join(""))]}return n.join("").split(V).filter(Boolean).map(r=>JSON.parse(r))}function q(e,t){var o;let n=[];for(let c=e.length*.5;c--;){let u=`${W[e[c*2].codePointAt(0)]}${W[e[c*2+1].codePointAt(0)]}`;n.unshift(String.fromCharCode(parseInt(u,16)))}let r=[],s=[n.join("")],i=10;for(;s.length;){let c=s.shift();try{if(r.push(JSON.parse(c)),t)return r}catch(u){if(!i--)throw u;let l=+((o=u.message.match(/\sposition\s(\d+)$/))==null?void 0:o[1]);if(!l)throw u;s.unshift(c.substring(0,l),c.substring(l))}}return r}function ee(e){var t;return{cleaned:e.replace(C,""),encoded:((t=e.match(C))==null?void 0:t[0])||""}}function A(e,t){return Z(e,t)}function te(e){return D(e)}function ne(e){return X(e)}function re(e){return ee(e)}var oe=Object.prototype.hasOwnProperty,se=Object.prototype.toString,ce=function(t,o,n){if(se.call(o)!=="[object Function]")throw new TypeError("iterator must be a function");var r=t.length;if(r===+r)for(var s=0;s<r;s++)o.call(n,t[s],s,t);else for(var i in t)oe.call(t,i)&&o.call(n,t[i],i,t)},ie=ce,y=a;function a(e,t,o){if(arguments.length===3)return a.set(e,t,o);if(arguments.length===2)return a.get(e,t);var n=a.bind(a,e);for(var r in a)a.hasOwnProperty(r)&&(n[r]=a[r].bind(n,e));return n}a.get=function(t,o){for(var n=Array.isArray(o)?o:a.parse(o),r=0;r<n.length;++r){var s=n[r];if(!(typeof t=="object"&&s in t))throw new Error("Invalid reference token: "+s);t=t[s]}return t};a.set=function(t,o,n){var r=Array.isArray(o)?o:a.parse(o),s=r[0];if(r.length===0)throw Error("Can not set the root object");for(var i=0;i<r.length-1;++i){var c=r[i];typeof c!="string"&&typeof c!="number"&&(c=String(c)),!(c==="__proto__"||c==="constructor"||c==="prototype")&&(c==="-"&&Array.isArray(t)&&(c=t.length),s=r[i+1],c in t||(s.match(/^(\d+|-)$/)?t[c]=[]:t[c]={}),t=t[c])}return s==="-"&&Array.isArray(t)&&(s=t.length),t[s]=n,this};a.remove=function(e,t){var o=Array.isArray(t)?t:a.parse(t),n=o[o.length-1];if(n===void 0)throw new Error('Invalid JSON pointer for remove: "'+t+'"');var r=a.get(e,o.slice(0,-1));if(Array.isArray(r)){var s=+n;if(n===""&&isNaN(s))throw new Error('Invalid array index: "'+n+'"');Array.prototype.splice.call(r,s,1)}else delete r[n]};a.dict=function(t,o){var n={};return a.walk(t,function(r,s){n[s]=r},o),n};a.walk=function(t,o,n){var r=[];n=n||function(s){var i=Object.prototype.toString.call(s);return i==="[object Object]"||i==="[object Array]"},function s(i){ie(i,function(c,u){r.push(String(u)),n(c)?s(c):o(c,a.compile(r)),r.pop()})}(t)};a.has=function(t,o){try{a.get(t,o)}catch(n){return!1}return!0};a.escape=function(t){return t.toString().replace(/~/g,"~0").replace(/\//g,"~1")};a.unescape=function(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")};a.parse=function(t){if(t==="")return[];if(t.charAt(0)!=="/")throw new Error("Invalid JSON pointer: "+t);return t.substring(1).split(/\//).map(a.unescape)};a.compile=function(t){return t.length===0?"":"/"+t.map(a.escape).join("/")};const U=({pointer:e,mappings:t,data:o,hiddenStrings:n})=>{const r=t[e];delete t[e];const s=j(o,e);for(const i of s){t[i]=r;const c=y.get(o,i),u=A(c,n);y.set(o,i,u)}},j=(e,t="")=>{const o=[],n=y.get(e,t);if(n.content)for(let r=0;r<n.content.length;r++)n.content[r].nodeType==="text"?o.push(`${t}/content/${r}/value`):o.push(...j(e,`${t}/content/${r}`));return o},O=({entityId:e,entityType:t,space:o,environment:n,field:r,locale:s,editorInterface:i,fieldType:c,targetOrigin:u,platform:l})=>{const d={origin:"contentful.com",href:`${`${u||"https://app.contentful.com"}/spaces/${o}/environments/${n}`}/${t==="Entry"?"entries":"assets"}/${e}/?focusedField=${r}&focusedLocale=${s}&source=vercel-content-link`,contentful:{editorInterface:i,fieldType:c}};return l==="vercel"&&delete d.contentful,d},P=e=>["builtin","sidebar-builtin","editor-builtin"].includes(e),M=e=>B.includes(e);function L(e){if(typeof structuredClone=="function")return structuredClone(e);try{return JSON.parse(JSON.stringify(e))}catch(t){return console.warn("Failed to clone data:",e,t),e}}const B=["singleLine","tagEditor","listInput","checkbox","richTextEditor","multipleLine"];function I(e,t,o,n,r,s,i){const c=i?t[i]:t;switch(e){case"Symbol":{const u=A(c,o);y.set(n,r,u);break}case"Text":{const u=A(c,o);y.set(n,r,u);break}case"RichText":{U({pointer:"",mappings:s,data:c,hiddenStrings:o});break}case"Array":{const u=c.map(l=>typeof l=="string"?A(l,o):l);y.set(n,r,u);break}}}const ae=(e,t,o)=>{if(!e||!e.extensions||!e.extensions.contentSourceMaps)return console.error("GraphQL response does not contain Content Source Maps information.",e),e;const n=L(e),{spaces:r,environments:s,editorInterfaces:i,fields:c,locales:u,entries:l,assets:p,mappings:g,fieldTypes:v}=n.extensions.contentSourceMaps,h=n;for(const d in g){const{source:f}=g[d],m="entry"in f?l[f.entry]:p[f.asset],R="entry"in f?"Entry":"Asset";if(!m)return n;const S=r[m.space],E=s[m.environment],T=m.id,w=c[f.field],N=u[f.locale],b=i[f.editorInterface],J=v[f.fieldType];if(!(P(b.widgetNamespace)&&!M(b.widgetId))&&y.has(h,d)){const k=y.get(h,d);if(k!==null){const Q=O({entityId:T,entityType:R,space:S,environment:E,field:w,locale:N,editorInterface:b,fieldType:J,targetOrigin:t,platform:o});I(J,k,Q,h,d,g)}}}return n},$=(e,t,o,n,r)=>{if(!e.fields)return;const{contentSourceMaps:s}=e.sys;if(!s){console.error("Content source maps data is missing");return}const{mappings:i}=s;for(const c in i){const{source:u}=i[c],l=e.sys.space.sys.id,p=e.sys.environment.sys.id,g=e.sys.id,v=e.sys.type,h=t[u.fieldType],d=o[u.editorInterface];if(P(d.widgetNamespace)&&!M(d.widgetId))continue;const f=c.startsWith("/")?c:`/${c}`;if(y.has(e,f)){const m=y.get(e,f);if(m===null)return;const S=f.split("/").pop();if(!S){console.error("Field name could not be extracted from the pointer",f);return}const E=e.sys.locale;if(E){const T=O({entityId:g,entityType:v,space:l,environment:p,field:S,locale:E,editorInterface:d,fieldType:h,targetOrigin:n,platform:r});I(h,m,T,e,f,i)}else Object.keys(m).forEach(w=>{const N=O({entityId:g,entityType:v,space:l,environment:p,field:S,locale:w,editorInterface:d,fieldType:h,targetOrigin:n,platform:r});I(h,m,N,e,`${f}/${w}`,i,w)})}}},ue=(e,t,o)=>{var r;const n=L(e);if(n.sys&&"items"in n){const s=n;if(!((r=s.sys)!=null&&r.contentSourceMapsLookup))return console.error("Content source maps lookup data is missing"),s;const{contentSourceMapsLookup:{fieldTypes:i,editorInterfaces:c}}=s.sys,{items:u,includes:l}=s;u.forEach(p=>$(p,i,c,t,o)),l&&l.Entry&&l.Entry.forEach(p=>$(p,i,c,t,o)),l&&l.Asset&&l.Asset.forEach(p=>$(p,i,c,t,o))}else{const s=n;if(!s.sys.contentSourceMapsLookup)return console.error("Content source maps lookup data is missing"),s;$(s,s.sys.contentSourceMapsLookup.fieldTypes,s.sys.contentSourceMapsLookup.editorInterfaces,t,o)}return n};exports.SUPPORTED_WIDGETS=B;exports.clone=L;exports.combine=A;exports.createSourceMapMetadata=O;exports.decode=ne;exports.encode=te;exports.encodeCPAResponse=ue;exports.encodeField=I;exports.encodeGraphQLResponse=ae;exports.encodeRichTextValue=U;exports.isBuiltinNamespace=P;exports.isSupportedWidget=M;exports.splitEncoding=re;
//# sourceMappingURL=index.cjs.map
